"0","#Obtain reference based estimates (RBE) from results and multiply by 100 to get percentages"
"0","RBE <- 100 * results$bulk.props"
"0","#convert to dataframe for ggplot2"
"0","RBE.df <- data.frame(RBE)"
"0",""
"0","#transpose dataframe for use with ggplot"
"0","RBE.df.t <- as.data.frame(t(RBE.df))"
"0",""
"0","#remove multiples"
"0","RBE.df.t$Multiplet <- NULL"
"0",""
"0",""
"0","#Define Subject Names from Bulk dataset"
"0","RBE.df.t$subject <- rownames(RBE.df.t)"
"0",""
"0","#Gather all information in one column defined by subject and celltypes"
"0","RBE.df.t %>% gather(key=""celltype"", value = ""value"", -subject) -> RBE.df.t.g"
"0",""
"0",""
"0","#add column with Subject number for grouping"
"0","substr(RBE.df.t.g$subject, 1, 8) -> RBE.df.t.g$patient"
"0",""
"0","#Plot all data in a single graph."
"0","ggplot(RBE.df.t.g, aes(fill=patient, y=value, x=celltype, colour=patient)) + "
"0","  geom_jitter(stat=""identity"", width = 0.25) + "
"0","  ylab(""% of all celltypes"") + "
"0","  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +"
"0","  guides(fill=FALSE) +"
"0","  theme(panel.background = element_rect(fill = ""white"", size = 0.5, color = ""black"")) +"
"0","  theme(panel.grid.major = element_line(colour = ""gray90"")) + "
"0","  theme(panel.grid.minor = element_line(colour = ""gray90"")) + theme(legend.key = element_rect(fill=""white"")) "
